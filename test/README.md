# 测试文件说明

本目录包含所有测试脚本，用于验证波形可视化工具的功能和性能。

## 测试文件列表

### 1. test_basic.py
**基本功能测试**

测试重构后的代码是否能够正常工作。

**测试内容**：
- 模块导入测试
- 文件查找器测试
- 通道选择器测试
- 插件管理器测试
- COMTRADE读取器测试

**运行方式**：
```bash
# 从项目根目录运行
python test/test_basic.py

# 或从test目录运行
cd test
python test_basic.py
```

---

### 2. test_vertical_spacing_fix.py
**垂直间距修复验证测试**

验证动态计算的 vertical_spacing 对于不同数量的通道都能正常工作。

**测试内容**：
- 间距计算逻辑测试（1-100个通道）
- 实际可视化功能测试（使用所有通道）

**运行方式**：
```bash
python test/test_vertical_spacing_fix.py
```

---

### 3. test_performance.py
**性能对比测试**

测试不同可视化器的渲染性能和文件大小。

**测试内容**：
- 标准模式（Scatter SVG渲染）
- 优化模式（Scattergl WebGL渲染）
- 快速模式（激进优化）

**输出结果**：
- 渲染时间对比
- 文件大小对比
- 性能提升百分比

**运行方式**：
```bash
python test/test_performance.py
```

---

### 4. interactive_test.py
**交互性能对比测试**

生成两个HTML文件供用户在浏览器中对比交互性能。

**生成文件**：
- `对比测试_标准模式_SVG渲染.html` - SVG渲染版本
- `对比测试_优化模式_WebGL渲染.html` - WebGL渲染版本

**测试方法**：
1. 运行脚本生成对比文件
2. 在浏览器中打开两个文件
3. 使用鼠标滚轮zoom in/out
4. 对比缩放流畅度和空白间隙

**运行方式**：
```bash
python test/interactive_test.py
```

---

## 快速运行所有测试

```bash
# 从项目根目录
python test/test_basic.py
python test/test_vertical_spacing_fix.py
python test/test_performance.py
```

---

## 注意事项

1. **工作目录**：所有测试脚本都使用绝对路径引用，可以从项目根目录或test目录运行
2. **测试数据**：测试需要 `waves/` 目录中有COMTRADE波形文件
3. **自动清理**：性能测试会自动清理生成的临时文件
4. **交互测试**：`interactive_test.py` 生成的对比文件需要手动删除

---

## 测试结果说明

### 性能测试预期结果

对于47个通道、6000个数据点的测试文件：

| 模式 | 渲染时间 | 文件大小 | 缩放流畅度 |
|------|---------|---------|-----------|
| 标准模式 | ~0.7s | ~10MB | 卡顿 |
| 优化模式 | ~0.8s | ~5MB | 流畅 |
| 快速模式 | ~0.3s | ~2MB | 极流畅 |

**关键要点**：
- 优化模式的初始渲染略慢，但**交互性能显著提升**
- 文件大小减小50-80%
- 空白间隙减少40-60%

---

## 故障排除

**Q: 测试提示"未找到测试文件"？**

A: 确保 `waves/` 目录中包含COMTRADE文件（.cfg和.dat）

**Q: 导入错误？**

A: 确保从项目根目录运行，或检查 `sys.path` 设置

**Q: 性能测试结果不一致？**

A: 正常现象，性能受系统负载影响。多次运行取平均值。

---

**版本**: v2.0.3
**更新日期**: 2025-10-28
